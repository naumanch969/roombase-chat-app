(()=>{"use strict";const e=document.getElementById("chat-form"),t=document.querySelector(".chat-messages"),n=document.getElementById("room-name"),o=document.getElementById("users"),s=document.getElementById("user-count"),r=Qs.parse(location.search,{ignoreQueryPrefix:!0}),a=r.username,c=r.room,i=io();function d(e,t="success"){const n=document.createElement("div");n.classList.add("notification",`notification-${t}`),n.textContent=e,document.body.appendChild(n),setTimeout(()=>{n.classList.add("show")},10),setTimeout(()=>{n.classList.remove("show"),setTimeout(()=>{n.remove()},300)},3e3)}i.on("usernameError",e=>{alert(e),window.location.href="/"}),i.emit("joinRoom",{username:a,room:c}),i.on("roomUsers",e=>{var t,r;t=e.room,n.innerHTML=t,r=e.users,o.innerHTML=`\n    ${r.map(e=>`<li>${e.username}</li>`).join("")}\n  `,s&&(s.textContent=`(${r.length})`)}),i.on("message",e=>{!function(e){const n=document.createElement("div");n.classList.add("message"),n.setAttribute("data-message-id",e.id);const o=e.edited?'<span class="edited-badge">edited</span>':"";n.innerHTML=`<p class="meta">\n      ${e.username} \n      <span>${e.time}</span>\n      ${o}\n      <button class="copy-id-btn" data-id="${e.id}" title="Copy message ID">\n         <i class="fas fa-copy"></i>\n      </button>\n   </p>\n   <p class="text">\n      ${e.text}\n   </p>`;const s=n.querySelector(".copy-id-btn");s&&s.addEventListener("click",()=>{var t;t=e.id,navigator.clipboard.writeText(t).then(()=>{d(`ID copied: ${t}`,"success")}).catch(e=>{console.error("Failed to copy message ID:",e),d("Failed to copy message ID","error")})}),t.appendChild(n)}(e),t.scrollTop=t.scrollHeight}),i.on("messageEdited",e=>{const t=document.querySelector(`[data-message-id="${e.id}"]`);if(t){const n=t.querySelector(".text");n&&(n.textContent=e.text);const o=t.querySelector(".meta");if(o&&!o.querySelector(".edited-badge")){const e=o.querySelector(".copy-id-btn"),t=document.createElement("span");t.className="edited-badge",t.textContent="edited",e&&o.insertBefore(t,e)}}}),i.on("messageDeleted",e=>{const t=document.querySelector(`[data-message-id="${e.id}"]`);t&&(t.style.opacity="0",t.style.transform="translateX(-20px)",setTimeout(()=>{t.remove()},300))}),i.on("error",e=>{console.error("Server error:",e),d(e,"error")}),i.on("warning",e=>{console.warn("Server warning:",e),d(e,"warning")}),e.addEventListener("submit",e=>{e.preventDefault();const t=e.target.elements.namedItem("msg"),n=t.value;i.emit("chatMessage",n),t.value="",t.focus()})})();
//# sourceMappingURL=script.js.map