{"version":3,"file":"script.js","mappings":"mBA6BA,MAAMA,EAAWC,SAASC,eAAe,aACnCC,EAAeF,SAASG,cAAc,kBACtCC,EAAWJ,SAASC,eAAe,aACnCI,EAAWL,SAASC,eAAe,SACnCK,EAAYN,SAASC,eAAe,cAGpCM,EAAcC,GAAGC,MAAMC,SAASC,OAAQ,CAC3CC,mBAAmB,IAEhBC,EAAmBN,EAAYM,SAC/BC,EAAeP,EAAYO,KAG3BC,EAASC,KA+Jf,SAASC,EAAiBC,EAAiBC,EAAwC,WAChF,MAAMC,EAAepB,SAASqB,cAAc,OAC5CD,EAAaE,UAAUC,IAAI,eAAgB,gBAAgBJ,KAC3DC,EAAaI,YAAcN,EAC3BlB,SAASyB,KAAKC,YAAYN,GAE1BO,WAAW,KACRP,EAAaE,UAAUC,IAAI,SAC3B,IAEHI,WAAW,KACRP,EAAaE,UAAUM,OAAO,QAC9BD,WAAW,KACRP,EAAaQ,UACb,MACH,IACN,CA1KAb,EAAOc,GAAG,gBAAkBC,IACzBC,MAAMD,GACNE,OAAOtB,SAASuB,KAAO,MAM1BlB,EAAOmB,KAAK,WAAY,CAAErB,WAAUC,SAKpCC,EAAOc,GAAG,YAAcM,IAmKxB,IAAwBC,EAQHC,EARGD,EAlKND,EAAKrB,KAmKpBV,EAASkC,UAAYF,EAOHC,EAzKNF,EAAKE,MA0KjBhC,EAASiC,UAAY,SAClBD,EAAME,IAAKC,GAAS,OAAOA,EAAK3B,iBAAiB4B,KAAK,UAIrDnC,IACDA,EAAUkB,YAAc,IAAIa,EAAMK,aA1KxC3B,EAAOc,GAAG,UAAYX,KAqFtB,SAAuBA,GACpB,MAAMyB,EAAM3C,SAASqB,cAAc,OACnCsB,EAAIrB,UAAUC,IAAI,WAClBoB,EAAIC,aAAa,kBAAmB1B,EAAQ2B,IAE5C,MAAMC,EAAc5B,EAAQ6B,OAAS,2CAA6C,GAElFJ,EAAIL,UAAY,2BACXpB,EAAQL,0BACFK,EAAQ8B,sBACdF,iDACqC5B,EAAQ2B,4HAK7C3B,EAAQ+B,gBAIb,MAAMC,EAAUP,EAAIxC,cAAc,gBAC9B+C,GACDA,EAAQC,iBAAiB,QAAS,KAYxC,IAAuBC,IAXAlC,EAAQ2B,GAY5BQ,UAAUC,UAAUC,UAAUH,GAAWI,KAAK,KAC3CvC,EAAiB,cAAcmC,IAAa,aAC5CK,MAAOC,IACPC,QAAQC,MAAM,6BAA8BF,GAC5CzC,EAAiB,4BAA6B,aAZjDf,EAAawB,YAAYiB,EAC5B,CAhHGkB,CAAc3C,GAGdhB,EAAa4D,UAAY5D,EAAa6D,eAMzChD,EAAOc,GAAG,gBAAkBM,IACzB,MAAM6B,EAAahE,SAASG,cAAc,qBAAqBgC,EAAKU,QACpE,GAAImB,EAAY,CACb,MAAMC,EAAcD,EAAW7D,cAAc,SACzC8D,IACDA,EAAYzC,YAAcW,EAAKc,MAIlC,MAAMiB,EAAcF,EAAW7D,cAAc,SAC7C,GAAI+D,IAAgBA,EAAY/D,cAAc,iBAAkB,CAC7D,MAAM+C,EAAUgB,EAAY/D,cAAc,gBACpC2C,EAAc9C,SAASqB,cAAc,QAC3CyB,EAAYqB,UAAY,eACxBrB,EAAYtB,YAAc,SACtB0B,GACDgB,EAAYE,aAAatB,EAAaI,EAE5C,CACH,IAMHnC,EAAOc,GAAG,iBAAmBM,IAC1B,MAAM6B,EAAahE,SAASG,cAAc,qBAAqBgC,EAAKU,QAChEmB,IACDA,EAAWK,MAAMC,QAAU,IAC3BN,EAAWK,MAAME,UAAY,oBAC7B5C,WAAW,KACRqC,EAAWpC,UACX,QAOTb,EAAOc,GAAG,QAAU2C,IACjBb,QAAQC,MAAM,gBAAiBY,GAC/BvD,EAAiBuD,EAAU,WAM9BzD,EAAOc,GAAG,UAAY4C,IACnBd,QAAQe,KAAK,kBAAmBD,GAChCxD,EAAiBwD,EAAY,aAMhC1E,EAASoD,iBAAiB,SAAWwB,IAClCA,EAAEC,iBAEF,MAAMC,EAAYF,EAAEG,OAA2BC,SAASC,UACrD,OAEGlD,EAAM+C,EAASI,MAGrBlE,EAAOmB,KAAK,cAAeJ,GAG3B+C,EAASI,MAAQ,GACjBJ,EAASK,S","sources":["webpack://chatapplication/./public/js/script.ts"],"sourcesContent":["/**\n * Client-side chat application\n * Handles Socket.IO communication and DOM updates\n */\n\n// Type definitions for Qs library\ninterface QsParseOptions {\n   ignoreQueryPrefix?: boolean;\n}\n\ndeclare const Qs: {\n   parse: (str: string, options?: QsParseOptions) => Record<string, string>;\n};\n\ninterface Message {\n   id: string;\n   username: string;\n   text: string;\n   time: string;\n   edited?: boolean;\n   parentId?: string;\n}\n\ninterface RoomUsersData {\n   room: string;\n   users: Array<{ username: string }>;\n}\n\n// DOM elements\nconst chatForm = document.getElementById(\"chat-form\") as HTMLFormElement;\nconst chatMessages = document.querySelector(\".chat-messages\") as HTMLDivElement;\nconst roomName = document.getElementById(\"room-name\") as HTMLElement;\nconst userList = document.getElementById(\"users\") as HTMLUListElement;\nconst userCount = document.getElementById(\"user-count\") as HTMLElement;\n\n// Get username and room from URL query parameters\nconst queryParams = Qs.parse(location.search, {\n   ignoreQueryPrefix: true,\n});\nconst username: string = queryParams.username as string;\nconst room: string = queryParams.room as string;\n\n// Initialize Socket.IO connection\nconst socket = io();\n\n/**\n * Handle username error (duplicate username)\n */\nsocket.on(\"usernameError\", (msg: string) => {\n   alert(msg);\n   window.location.href = \"/\";\n});\n\n/**\n * Emit join room event with username and room data\n */\nsocket.emit(\"joinRoom\", { username, room });\n\n/**\n * Handle room users update\n */\nsocket.on(\"roomUsers\", (data: RoomUsersData) => {\n   outputRoomName(data.room);\n   outputUsers(data.users);\n});\n\n/**\n * Handle incoming messages from server\n */\nsocket.on(\"message\", (message: Message) => {\n   outputMessage(message);\n\n   // Auto-scroll to latest message\n   chatMessages.scrollTop = chatMessages.scrollHeight;\n});\n\n/**\n * Handle message edits from server\n */\nsocket.on(\"messageEdited\", (data: { id: string; text: string; edited: boolean; time: string }) => {\n   const messageDiv = document.querySelector(`[data-message-id=\"${data.id}\"]`) as HTMLDivElement;\n   if (messageDiv) {\n      const textElement = messageDiv.querySelector(\".text\") as HTMLParagraphElement;\n      if (textElement) {\n         textElement.textContent = data.text;\n      }\n\n      // Add or update edited badge\n      const metaElement = messageDiv.querySelector(\".meta\") as HTMLParagraphElement;\n      if (metaElement && !metaElement.querySelector(\".edited-badge\")) {\n         const copyBtn = metaElement.querySelector(\".copy-id-btn\");\n         const editedBadge = document.createElement(\"span\");\n         editedBadge.className = \"edited-badge\";\n         editedBadge.textContent = \"edited\";\n         if (copyBtn) {\n            metaElement.insertBefore(editedBadge, copyBtn);\n         }\n      }\n   }\n});\n\n/**\n * Handle message deletes from server\n */\nsocket.on(\"messageDeleted\", (data: { id: string }) => {\n   const messageDiv = document.querySelector(`[data-message-id=\"${data.id}\"]`) as HTMLDivElement;\n   if (messageDiv) {\n      messageDiv.style.opacity = \"0\";\n      messageDiv.style.transform = \"translateX(-20px)\";\n      setTimeout(() => {\n         messageDiv.remove();\n      }, 300);\n   }\n});\n\n/**\n * Handle error messages from server\n */\nsocket.on(\"error\", (errorMsg: string) => {\n   console.error(\"Server error:\", errorMsg);\n   showNotification(errorMsg, \"error\");\n});\n\n/**\n * Handle warning messages from server\n */\nsocket.on(\"warning\", (warningMsg: string) => {\n   console.warn(\"Server warning:\", warningMsg);\n   showNotification(warningMsg, \"warning\");\n});\n\n/**\n * Handle chat form submission\n */\nchatForm.addEventListener(\"submit\", (e: SubmitEvent) => {\n   e.preventDefault();\n\n   const msgInput = (e.target as HTMLFormElement).elements.namedItem(\n      \"msg\"\n   ) as HTMLInputElement;\n   const msg = msgInput.value;\n\n   // Emit message to server\n   socket.emit(\"chatMessage\", msg);\n\n   // Clear input and refocus\n   msgInput.value = \"\";\n   msgInput.focus();\n});\n\n/**\n * Output message to the DOM\n * @param message - The message object containing username, text, and time\n */\nfunction outputMessage(message: Message): void {\n   const div = document.createElement(\"div\");\n   div.classList.add(\"message\");\n   div.setAttribute(\"data-message-id\", message.id);\n\n   const editedBadge = message.edited ? '<span class=\"edited-badge\">edited</span>' : '';\n\n   div.innerHTML = `<p class=\"meta\">\n      ${message.username} \n      <span>${message.time}</span>\n      ${editedBadge}\n      <button class=\"copy-id-btn\" data-id=\"${message.id}\" title=\"Copy message ID\">\n         <i class=\"fas fa-copy\"></i>\n      </button>\n   </p>\n   <p class=\"text\">\n      ${message.text}\n   </p>`;\n\n   // Add click event listener to copy button\n   const copyBtn = div.querySelector(\".copy-id-btn\") as HTMLButtonElement;\n   if (copyBtn) {\n      copyBtn.addEventListener(\"click\", () => {\n         copyMessageId(message.id);\n      });\n   }\n\n   chatMessages.appendChild(div);\n}\n\n/**\n * Copy message ID to clipboard\n * @param messageId - The ID of the message to copy\n */\nfunction copyMessageId(messageId: string): void {\n   navigator.clipboard.writeText(messageId).then(() => {\n      showNotification(`ID copied: ${messageId}`, \"success\");\n   }).catch((err) => {\n      console.error(\"Failed to copy message ID:\", err);\n      showNotification(\"Failed to copy message ID\", \"error\");\n   });\n}\n\n/**\n * Show a notification to the user\n * @param message - The message to display\n * @param type - The type of notification (success, error, warning)\n */\nfunction showNotification(message: string, type: \"success\" | \"error\" | \"warning\" = \"success\"): void {\n   const notification = document.createElement(\"div\");\n   notification.classList.add(\"notification\", `notification-${type}`);\n   notification.textContent = message;\n   document.body.appendChild(notification);\n\n   setTimeout(() => {\n      notification.classList.add(\"show\");\n   }, 10);\n\n   setTimeout(() => {\n      notification.classList.remove(\"show\");\n      setTimeout(() => {\n         notification.remove();\n      }, 300);\n   }, 3000);\n}\n\n/**\n * Update room name in the DOM\n * @param roomName - The name of the current room\n */\nfunction outputRoomName(roomNameValue: string): void {\n   roomName.innerHTML = roomNameValue;\n}\n\n/**\n * Update users list in the DOM\n * @param users - Array of users in the room\n */\nfunction outputUsers(users: Array<{ username: string }>): void {\n   userList.innerHTML = `\n    ${users.map((user) => `<li>${user.username}</li>`).join(\"\")}\n  `;\n\n   // Update user count badge\n   if (userCount) {\n      userCount.textContent = `(${users.length})`;\n   }\n}\n"],"names":["chatForm","document","getElementById","chatMessages","querySelector","roomName","userList","userCount","queryParams","Qs","parse","location","search","ignoreQueryPrefix","username","room","socket","io","showNotification","message","type","notification","createElement","classList","add","textContent","body","appendChild","setTimeout","remove","on","msg","alert","window","href","emit","data","roomNameValue","users","innerHTML","map","user","join","length","div","setAttribute","id","editedBadge","edited","time","text","copyBtn","addEventListener","messageId","navigator","clipboard","writeText","then","catch","err","console","error","outputMessage","scrollTop","scrollHeight","messageDiv","textElement","metaElement","className","insertBefore","style","opacity","transform","errorMsg","warningMsg","warn","e","preventDefault","msgInput","target","elements","namedItem","value","focus"],"ignoreList":[],"sourceRoot":""}